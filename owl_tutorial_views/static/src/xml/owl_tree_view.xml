<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

    <div t-name="owl_tutorial_views.OWLTreeRenderer" class="o_owl_tree_view" owl="1">
        <div class="container mt-4">
            <t t-foreach="props.data" t-as="item" t-key="item.id">
                <div class="row">
                    <div class="col">
                        <ImpressionComponent data="item" />
                    </div>
                </div>
            </t>
        </div>
    </div>


    <div
        t-name="owl_tutorial_views.ImpressionComponent"
        class="o_impression_component"
        owl="1"
    >
        <div class="container-fluid">
            <div class="row style-header">
                <div class="col-3">
                    <span t-esc="state.data.data.encounter_id.data.display_name" />
                </div>
                <div class="col-3">
                    <span
                        t-esc="state.data.data.validation_user_id.data.display_name"
                        t-if="state.data.data.validation_user_id"
                    />
                </div>
                <div class="col-3">
                    <span
                        t-esc="timeFromNow"
                        t-if="state.data.data.validation_date"
                        t-att-title="datetime"
                    />
                </div>
                <div class="col-3">
                    <span t-esc="state.data.data.specialty_id.data.display_name" />
                </div>
            </div>
            <div class="row">
                <div class="col-4">
                    <span
                        t-esc="state.data.data.summary"
                        t-if="state.data.data.summary &amp;&amp; !state.edit"
                    />
                    <FieldAdapter Component="FieldText" widgetArgs="['summary', state.data, {mode: 'edit', viewType: 'owl_tree', attrs: {}}]" t-if="state.edit"/>
                </div>
                <div class="col-4">
                <span
                        t-esc="state.data.data.note"
                        t-if="state.data.data.note &amp;&amp; !state.edit"
                    />
                    <FieldAdapter Component="FieldText" widgetArgs="['note', state.data, {mode: 'edit', viewType: 'owl_tree', attrs: {}}]" t-if="state.edit"/>
                </div>
                <div class="col-4">
                <span
                        t-esc="state.data.data.description"
                        t-if="state.data.data.description &amp;&amp; !state.edit"
                    />
                    <FieldAdapter Component="FieldText" widgetArgs="['description', state.data, {mode: 'edit', viewType: 'owl_tree', attrs: {}}]" t-if="state.edit"/>
                </div>
            </div>
            <div class="row">
                <div class="col-5">
                    <FieldAdapter Component="FieldMany2ManyTags" widgetArgs="['finding_ids', state.data, {mode: 'readonly'}]" t-if="!state.edit"/>
                    <FieldAdapter Component="FieldMany2ManyTags" widgetArgs="['finding_ids', state.data, {mode: 'edit', viewType: 'owl_tree', attrs: {}}]" t-if="state.edit"/>
                </div>
                <div class="col-5">
                    <FieldAdapter Component="FieldMany2ManyTags" widgetArgs="['allergy_substance_ids', state.data, {mode: 'readonly'}]" t-if="!state.edit"/>
                    <FieldAdapter Component="FieldMany2ManyTags" widgetArgs="['allergy_substance_ids', state.data, {mode: 'edit', viewType: 'owl_tree', attrs: {}}]" t-if="state.edit"/>
                </div>
                <div class="col-2 d-flex justify-content-end">
                    <button
                        class="btn btn-primary"
                        t-on-click="onEdit"
                        t-if="state.data.data.fhir_state == 'in_progress' &amp;&amp; !state.edit"
                    >
                        <i class="fas fa-edit" />
                    </button>

                    <button
                        class="btn btn-primary"
                        t-on-click="onSave"
                        t-if="state.data.data.fhir_state == 'in_progress' &amp;&amp; state.edit"
                    >
                        <i class="fas fa-save" />
                    </button>

                    <button
                        class="btn btn-primary"
                        t-on-click="onValidate"
                        t-if="state.data.data.fhir_state == 'in_progress'"
                    >
                        <i class="fas fa-check" />
                    </button>

                    <button
                        class="btn btn-secondary"
                        t-if="state.data.data.fhir_state == 'in_progress'"
                        t-on-click="onCancel"
                    >
                        <i class="fas fa-times" />
                    </button>
                </div>

            </div>
        </div>
    </div>
    <t t-name="OwlTreeView.buttons">
        <div class="o_owltree_buttons" role="toolbar" aria-label="Main actions">
            <button
                type="button"
                class="btn btn-primary o_owltree_button_add"
                accesskey="c"
            >
                Create
            </button>

        </div>
    </t>

</templates>
